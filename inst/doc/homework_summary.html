<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wei Feng" />

<meta name="date" content="2022-12-07" />

<title>Introduction to homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to homework</h1>
<h4 class="author">Wei Feng</h4>
<h4 class="date">2022-12-07</h4>



<style>
body{ 
font-size: 18px;
}
</style>
<p>This vignettes file is about all my homework answers.</p>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>Use knitr to produce at least 3 examples(texts,figure,table)</p>
<div id="answer1" class="section level3">
<h3>Answer1</h3>
<p>Analyze the data set iris in R</p>
<ol style="list-style-type: decimal">
<li>We will show what the iris looks like.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(iris)</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 145          6.7         3.3          5.7         2.5 virginica
## 146          6.7         3.0          5.2         2.3 virginica
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<p>From the table we can see that the iris is made up of five columns :
Sepal Length, Sepal Width Length , Petal Width , Species . In order to
have a preliminary understanding of the iris dataset , we can use
‘summary’ function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>From the outcome , we can see the minimum value , maximum value ,
median , mean , quartile of each feature . Besides , we can also learn
that there are three different species in iris dataset , setosa ,
versicolor , virginica . Each specie has the same sample size .</p>
<ol start="2" style="list-style-type: decimal">
<li>We want to draw a picture to show the relationship between petal
length and petal width . We can use “ggplot2” to help us finish this job
. If we want to show the density of the species in the picture , we can
use “ggMarginal” funtion .</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># classic plot</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width, <span class="at">color =</span> Species), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Petal Length&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Petal Width&quot;</span>) </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p, <span class="at">type =</span> <span class="st">&quot;density&quot;</span>, <span class="at">groupColour =</span> <span class="cn">TRUE</span>, <span class="at">groupFill =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ol start="3" style="list-style-type: decimal">
<li>If we want to use latex to generate a table , but we may not
familiar with latex , we can use “xtable::xtable” to help us producing
Latex code for a table.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xtable</span>(<span class="fu">tail</span>(iris))</span></code></pre></div>
<pre><code>## % latex table generated in R 4.2.2 by xtable 1.8-4 package
## % Wed Dec  7 15:31:56 2022
## \begin{table}[ht]
## \centering
## \begin{tabular}{rrrrrl}
##   \hline
##  &amp; Sepal.Length &amp; Sepal.Width &amp; Petal.Length &amp; Petal.Width &amp; Species \\ 
##   \hline
## 145 &amp; 6.70 &amp; 3.30 &amp; 5.70 &amp; 2.50 &amp; virginica \\ 
##   146 &amp; 6.70 &amp; 3.00 &amp; 5.20 &amp; 2.30 &amp; virginica \\ 
##   147 &amp; 6.30 &amp; 2.50 &amp; 5.00 &amp; 1.90 &amp; virginica \\ 
##   148 &amp; 6.50 &amp; 3.00 &amp; 5.20 &amp; 2.00 &amp; virginica \\ 
##   149 &amp; 6.20 &amp; 3.40 &amp; 5.40 &amp; 2.30 &amp; virginica \\ 
##   150 &amp; 5.90 &amp; 3.00 &amp; 5.10 &amp; 1.80 &amp; virginica \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>In addition , we can use knitr to output standard mathematical
formulas . We will show some functions commonly used in deep learning
below.</li>
</ol>
<p>Activation function:</p>
<p>1.sigmoid function: <span class="math display">\[\operatorname{sigmoid}(x)=\frac{1}{1+\exp
(-x)}\]</span></p>
<p>2.tanh function: <span class="math display">\[\tanh (x)=\frac{1-\exp
(-2 x)}{1+\exp (-2 x)}\]</span></p>
<p>Loss function:</p>
<ol style="list-style-type: decimal">
<li><p>L2 loss: <span class="math display">\[M S
E=\frac{\sum_{i=1}^{n}\left(y_{i}-y_{i}^{p}\right)^{2}}{n}\]</span></p></li>
<li><p>Cross-Entropy Loss: <span class="math display">\[\operatorname{Loss}=-\sum_{i=1}^{n} y_{i} \log
y_{i}^{\prime}\]</span></p></li>
</ol>
</div>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>The <span class="math inline">\(Pareto(a,b)\)</span> distribution has
cdf<br />
<span class="math display">\[F(x)=1-\left(\frac{b}{x}\right)^{a}, \quad
x \geq b&gt;0, a&gt;0\]</span> Derive the probability inverse
transformation <span class="math inline">\(F^{-1}(U)\)</span> and use
the inverse transform method to simulate a random sample with the <span class="math inline">\(Pareto(2,2)\)</span> distribution . Graph the
density histogram of sample with the <span class="math inline">\(Pareto(2,2)\)</span> denisty superimposed for
comparison .</p>
<div id="answer2" class="section level3">
<h3>Answer2</h3>
<p>The probability inverse transformation is <span class="math display">\[F^{-1}(U) =
\frac{b}{(1-u)^{\frac{1}{a}}}\]</span> If <span class="math inline">\(X
\sim Pareto(2,2)\)</span> , then <span class="math display">\[F^{-1}(U)
= \frac{2}{(1-u)^{\frac{1}{2}}}\]</span> and the probability density
function of X is <span class="math display">\[\begin{align*}
f(x) = &amp;F^{&#39;}(X)\\
=&amp;(\frac{2}{x})^{3}  ,\quad x \geq 2
\end{align*}\]</span> So we can use R to generate random numbers .</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22092</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>u)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob =</span><span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">F</span>(x)<span class="sc">==</span><span class="dv">1</span><span class="sc">-</span>(<span class="fu">frac</span>(<span class="dv">2</span>,x))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x),<span class="at">length=</span>n)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(<span class="dv">2</span><span class="sc">/</span>y)<span class="sc">^</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>Write a function to generate a random sample of size n from the <span class="math inline">\(Beta(a,b)\)</span> distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the <span class="math inline">\(Beta(3,2)\)</span> distribution. Graph
the histogram of the sample with the theoretical <span class="math inline">\(Beta(3,2)\)</span> density superimposed .</p>
<div id="answer3" class="section level3">
<h3>Answer3</h3>
<p>If <span class="math inline">\(X \sim Beta(a,b)\)</span> , then the
probability density function of X is <span class="math display">\[f(x)=\frac{\Gamma(a+b)}{\Gamma(a) \Gamma(b)}
x^{a-1}(1-x)^{b-1}, \quad 0 \leq x \leq 1\]</span> Let <span class="math inline">\(g(x)=1,\quad 0&lt;x&lt;1\)</span> , our aim is to
decide which c is better . <span class="math display">\[f^{&#39;}(x)
=\frac{\Gamma(a+b)}{\Gamma(a)
\Gamma(b)}((a-1)x^{a-2}(1-x)^(b-1)-(b-1)x^{a-1}(1-x)^{b-2})\]</span> Let
<span class="math inline">\(f^{&#39;}(x)=0\)</span> , we can know that
the maximum point of <span class="math inline">\(f(x)\)</span> is <span class="math inline">\(\frac{a-1}{a+b-2}\)</span> , so the maximum value
of <span class="math inline">\(f(x)\)</span> is <span class="math inline">\(f(\frac{a-1}{a+b-2}) =
\frac{\Gamma(a+b)}{\Gamma(a) \Gamma(b)}
(\frac{a-1}{a+b-2})^{a-1}(\frac{b-1}{a+b-2})^{b-1}\)</span> . So we can
Write a function to generate a random sample of size n from the <span class="math inline">\(Beta(a,b)\)</span> distribution .</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>randomNumber_beta<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(k<span class="sc">&lt;</span>n){</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">&gt;</span>u<span class="sc">*</span>((a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>))<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>((b<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>))<span class="sc">^</span>(b<span class="dv">-1</span>)){</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      y[k]<span class="ot">&lt;-</span>x</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>if <span class="math inline">\(a=3,b=2,n=1000\)</span>,then we can
use randomNumber_beta(1000,3,2) to generate 1000 samples .</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">randomNumber_beta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">prob =</span><span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fu">Gamma</span>(a<span class="sc">+</span>b),<span class="fu">Gamma</span>(a) <span class="sc">*</span><span class="fu">Gamma</span>(b))<span class="sc">*</span> x<span class="sc">^</span>{a<span class="dv">-1</span>}(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>{b<span class="dv">-1</span>}))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>z,<span class="at">y=</span><span class="fu">dbeta</span>(z,<span class="dv">3</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
<br>Besides , we can use quantile-quantile plot to have a examination .
</br> <img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<p>Simulate a continuous Exponential-Gamma mixture . Suppose that the
rate parameter has <span class="math inline">\(Gamma(\gamma,
\beta)\)</span> distribution and <span class="math inline">\(Y\)</span>
has <span class="math inline">\(Exp(\Lambda)\)</span> distribution .
That is , <span class="math inline">\((Y \mid \Lambda=\lambda) \sim
f_{Y}(y \mid \lambda)=\lambda e^{-\lambda y}\)</span> . Generate 1000
random observations from this mixture with <span class="math inline">\(\gamma = 4\)</span> and <span class="math inline">\(\beta = 2\)</span> .</p>
<div id="answer4" class="section level3">
<h3>Answer4</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,r,beta)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,lambda)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code></pre></div>
<pre><code>##  [1] 1.276309901 0.116841680 0.001017113 0.304626217 0.632273924 0.351838333
##  [7] 0.353024127 1.373147601 0.102551330 0.536224108 0.234278669 0.124876367
## [13] 0.289358363 0.077905647 0.252145852 0.329071355 0.060640321 0.596236419
## [19] 0.271134916 0.290527046</code></pre>
</div>
</div>
<div id="question5" class="section level2">
<h2>Question5</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a <span class="math inline">\(Pareto\)</span> distribution with cdf<br />
<span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y}\right)^{r},
\quad y \geq 0\]</span> (This is an alternative parameterization of the
<span class="math inline">\(Pareto\)</span> cdf given in Exercise 3.3) .
Generate 1000 random observations from the mixture with <span class="math inline">\(\gamma = 4\)</span> and <span class="math inline">\(\beta = 2\)</span> . Compare the empirical and
theoretical (<span class="math inline">\(Pareto\)</span>) distributions
by graphing the density histogram of the sample and superimposing the
<span class="math inline">\(Pareto\)</span> density curve</p>
<div id="answer5" class="section level3">
<h3>Answer5</h3>
<p><span class="math display">\[\begin{align*}
    P(Y\leq y)=&amp;\int_{0}^{+\infty}P(Y\leq
y|\Lambda=\lambda)*f(\lambda)d\lambda\\
    =&amp;\int_{0}^{+\infty}(1- e^{-\lambda
y})*\frac{\beta^{\gamma}}{\Gamma(\gamma)}*\lambda^{\gamma-1}e^{-\beta
\lambda}d\lambda\\
    =&amp;1-\left(\frac{\beta}{\beta+y}\right)^{r}\\
    \end{align*}\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,r,beta)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,lambda)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">F</span>(x)<span class="sc">==</span><span class="dv">1</span><span class="sc">-</span>(<span class="fu">frac</span>(beta,beta<span class="sc">+</span>y))<span class="sc">^</span>gamma))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x),<span class="at">length=</span>n)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="dv">64</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>y)<span class="sc">^</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question6" class="section level2">
<h2>Question6</h2>
<ul>
<li>1:
<ul>
<li>For <span class="math inline">\(n=10^4,2\times10^4,4\times10^4,6\times10^4,8\times10^4\)</span>,
apply the fast sorting algorithm to randomly permuted numbers of <span class="math inline">\(1,\ldots,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul></li>
</ul>
<div id="answer6" class="section level3">
<h3>Answer6</h3>
<ol style="list-style-type: decimal">
<li>We need to write a function about fast sorting algorithm .</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    sentinel<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>num,<span class="dv">1</span>)<span class="co">#random pick one number</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[sentinel]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span>sentinel]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can use “system.time” function to help us calculate computation
time . The function has three return values: user,system,elapse . We use
the first return value for comparison .</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span><span class="dv">1</span> <span class="co">#Fill the data in row i of the matrix</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">matrix</span>(<span class="at">nrow =</span><span class="dv">5</span>,<span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> ( j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    m[i,j]<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>a_n<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(m)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>a_n</span></code></pre></div>
<pre><code>## [1] 0.0567 0.1235 0.2386 0.3404 0.4507</code></pre>
<p>We will draw a scatter plot and regresssion line of <span class="math inline">\(t_n\)</span> and <span class="math inline">\(a_n\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a_n,t_n,<span class="at">main=</span><span class="st">&quot;Regression for Algorithm complexity with running time&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(t_n<span class="sc">~</span>a_n),<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the picture , we can see that the 5 points are approximately in
the regression line , so we can get a conclusion that the time
complexity of quick sort is <span class="math inline">\(O(nlog(n))\)</span>.</p>
</div>
</div>
<div id="question7" class="section level2">
<h2>Question7</h2>
<p>5.6 In Example 5.7 the control variate approach was illustrated for
Monte Carlo integration of <span class="math display">\[\theta =
\int_{0} ^{1} e^xdx.\]</span> Now consider the antithetic variate
approch . Compute <span class="math inline">\(Cov(e^u,e^{1-u})\)</span>
and <span class="math inline">\(Var(e^u+e^{1-u})\)</span> , where <span class="math inline">\(U \sim Uniform(0,1)\)</span> . What is the percent
reduction in variance of <span class="math inline">\(\hat
\theta\)</span> that can be achieved using antithetic variates(compared
with simple MC)?</p>
<div id="answer7" class="section level3">
<h3>Answer7</h3>
<p><span class="math display">\[\begin{align*}
E(e^u) =&amp; \int_{0} ^{1} e^udu
       =e-1\\
E(e^{1-u}) =&amp; \int_{0} ^{1} e^{1-u}du
           =e-1 \\
E(e^{2u}) =&amp; \int_{0} ^{1} e^{2u}du
       =\frac{1}{2} (e^2-1)\\
E(e^{2-2u}) =&amp; \int_{0} ^{1} e^{2-2u}du
       =\frac{1}{2} (e^2-1)      
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
Cov(e^u,e^{1-u}) =&amp; E(e^u-E(e^u))(e^{1-u}-E(e^{1-u}))\\
     =&amp; E(e^u-(e-1))(e^{1-u}-(1-u))\\
     =&amp; E(e-(e-1)(e^u+e^{1-u})+(e-1)^2)\\
     =&amp; e-(e-1)^2\\
     \doteq&amp;  -0.2342106\\
Var(e^u+e^{1-u}) =&amp; E(e^u+e^{1-u})^2-(E(e^u+e^{1-u}))^2\\
     =&amp; E(e^{2u}+e^{2-2u}+2e)-(2e-2)^2\\
     =&amp; -3e^2+10e-5\\
     \doteq&amp; 0.01564999
\end{align*}\]</span></p>
<p>We can use code to verify this result.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="fu">exp</span>(x),<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(x)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>cov;var</span></code></pre></div>
<pre><code>## [1] -0.2358316</code></pre>
<pre><code>## [1] 0.01562349</code></pre>
<p>If we use simple Monte Carlo approach with m replicate , the variance
of the estimator is <span class="math inline">\(\frac{Var(e^u)}{m}\)</span> , where <span class="math display">\[Var(e^u) = E(e^{2U})-(E(e^u))^2=\frac{1}{2}
e^2+2e-\frac{3}{2} \doteq 0.2420351\]</span> So the percent reduction in
variance of <span class="math inline">\(\hat \theta\)</span> is
100(1-0.01564999/2/0.2420356)=96.76701% .</p>
</div>
</div>
<div id="question8" class="section level2">
<h2>Question8</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6 .</p>
<div id="answer8" class="section level3">
<h3>Answer8</h3>
<p>The simple estimator is <span class="math display">\[\hat \theta =
\frac{1}{m} \sum_{j=1} ^{m} e^{U_j} , U_j \sim U(0,1) \]</span> The
antithetic variable estimator is <span class="math display">\[\hat
\theta&#39; = \frac{1}{m} \sum_{j=1} ^{m/2} (e^{U_j}+e^{(1-U_j)}) , U_j
\sim U(0,1) \]</span> Simple Monte Carlo method:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(x))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 1.724172</code></pre>
<p>Antithetic variate approach:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(u,v)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="fu">exp</span>(u)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">&lt;-</span><span class="fu">mean</span>(g)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>theta_hat</span></code></pre></div>
<pre><code>## [1] 1.717025</code></pre>
<p>We need to write a function integration method 1 and method 2, so
that we can repeat the experiment to calculate the variance.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span><span class="fu">exp</span>(u) </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">&lt;-</span> <span class="fu">mean</span>(g)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  theta</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(<span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(MC1);<span class="fu">var</span>(MC2);<span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(MC2)<span class="sc">/</span><span class="fu">var</span>(MC1)</span></code></pre></div>
<pre><code>## [1] 0.0002568227</code></pre>
<pre><code>## [1] 7.849959e-06</code></pre>
<pre><code>## [1] 0.9694343</code></pre>
</div>
</div>
<div id="question9" class="section level2">
<h2>Question9</h2>
<p>Find two importance function <span class="math inline">\(f_1\)</span>
and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x) =
\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}  \quad ,\quad x&gt;1\]</span>
Which of your two importance function should produce the smaller
variance in estimating <span class="math display">\[\int_{1}^{\infty}
\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span> by importance
sampling? Explain.</p>
<div id="answer9" class="section level3">
<h3>Answer9</h3>
<p>To calculate this integral, we can try to change the upper and lower
bounds of the integral .</p>
<p><span class="math display">\[\begin{align*}
\int_1 ^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx =&amp;
\int_0 ^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx - \int_0
^1\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx \\
=&amp; \int_0 ^{\infty}\frac{-x}{\sqrt{2\pi}} de^{-\frac{x^2}{2}} -
\int_0 ^1\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx \\
=&amp;  -\frac{x}{\sqrt(2\pi)}*e^{\frac{-x^2}{2}}|_0 ^{+\infty} + \int_0
^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx - \int_0
^1\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx \\
=&amp; \frac{1}{2} - \int_0 ^1\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}
dx

\end{align*}\]</span> So our goal is to calculate the following
integral: <span class="math display">\[ \int_0
^1\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\]</span></p>
<p>I choose 3 importance functions : <span class="math display">\[f_1(x)=\frac{4}{\pi *(1+x^2)} \quad ,\quad
0&lt;x&lt;1\]</span> <span class="math display">\[ f_2(x)=e^{-x} \quad
,\quad x&gt;0\]</span> <span class="math display">\[
f_3(x)=\frac{x}{1-e^{-\frac12}}e^{-\frac{x^2}{2}} \quad ,\quad
0&lt;x&lt;1\]</span> First, I will draw the pictures of these three
functions to observe the trend of the density function.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> pi)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span><span class="dv">4</span><span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>pi)),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x}),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">expression</span>(f[<span class="dv">3</span>](x)<span class="sc">==</span>x<span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>}<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>e<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>}))</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#for color change lty to col</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#figure (a)</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>), <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&#39;dentisy fucntion&#39;</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(x, f1, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(x, f3, <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> gs,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next , I draw the trend of the functions: <span class="math inline">\(\frac{g}{f_1},\frac{g}{f_2},\frac{g}{f_3}\)</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">3.2</span>), <span class="at">lwd =</span> w, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span> ,<span class="at">main=</span><span class="st">&#39;g/f&#39;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f3, <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">lwd =</span> w,<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It’s time to generate the random number and compute the
integration.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f1, inverse transform method</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tan</span>(pi <span class="sc">*</span> u <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="dv">4</span> <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> pi))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using f2</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f3, inverse transform method</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>u))</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>est[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>sd[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span></code></pre></div>
<p>We output the results in the form of a table.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">est=</span><span class="fu">round</span>(est,<span class="dv">3</span>), <span class="at">sd=</span><span class="fu">round</span>(sd,<span class="dv">3</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(res, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">f1</th>
<th align="center">f2</th>
<th align="center">f3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="center">0.099</td>
<td align="center">0.099</td>
<td align="center">0.099</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="center">0.105</td>
<td align="center">0.161</td>
<td align="center">0.037</td>
</tr>
</tbody>
</table>
<p>So the integral is : <span class="math display">\[\int_1
^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx= \frac{1}{2} -
\int_0 ^1\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}} dx = \frac12 - 0.099
= 0.401\]</span></p>
<p>From the table , we can see that <span class="math inline">\(f_3(x)=\frac{x}{1-e^{-\frac12}}e^{-\frac{x^2}{2}}
\quad ,\quad 0&lt;x&lt;1\)</span> has the minimum variance . As shown in
Figure g/f, the <span class="math inline">\(\frac{g(x)}{f_3(x)}\)</span>
approximation is a constant, so the variance is minimum.</p>
</div>
</div>
<div id="question10" class="section level2">
<h2>Question10</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<div id="answer10" class="section level3">
<h3>Answer10</h3>
<p>In Example 5.10 our best result was obtained with importance function
<span class="math inline">\(f_3(x) =\frac{e^{−x}}{1 − e^{-1}}, 0
&lt;x&lt; 1.\)</span> From 10000 replicates we obtained the
estimate<span class="math inline">\(\hat\theta = 0.5257801\)</span> and
an estimated standard error 0.0970314. Now divide the interval (0,1)
into five subintervals, <span class="math inline">\((\frac{j}{5},\frac{j+1}{5})\)</span>, j = 0, 1,…,
4.</p>
<p>In order for <span class="math inline">\(f_3(x)\)</span> to be a
density function in the interval <span class="math inline">\((\frac{j}{5},\frac{j+1}{5})\)</span>, we need to
multiply the term c. <span class="math display">\[
\int_{\frac{j}{5}}^{\frac{j+1}{5}} c
\frac{e^{-x}}{1-e^{-1}}dx=1\]</span> So <span class="math display">\[c =
\frac{1-e^{-1}}{e^{-\frac{j+1}{5}}-e^{-\frac{j}{5}}}\]</span></p>
Then on the <span class="math inline">\(j^{th}\)</span> subinterval
variables are generated from the density <span class="math display">\[
\frac{e^{-x}}{e^{-\frac{j+1}{5}}-e^{-\frac{j}{5}}} \quad , \quad
\frac{j}{5}&lt;x&lt;\frac{j+1}{5}\]</span>
<span class="math display">\[\begin{aligned}
\int_{0}^{1} e^{-x} /\left(1+x^{2}\right) d x &amp;=\sum_{j=1}^{k}
\int_{\frac{j-1}{k}}^{\frac{j}{k}} e^{-x} /\left(1+x^{2}\right) d x \\
&amp;=\sum_{j=1}^{k} \int_{\frac{j-1}{k}}^{\frac{j}{k}} \frac{e^{-x}
/\left(1+x^{2}\right)}{e^{-x}/{(e^{-\frac{j}{5}}-e^{-\frac{j-1}{5}}})}
*\frac{e^{-x}}{e^{-\frac{j}{5}}-e^{-\frac{j-1}{5}}}d x \\
&amp;=\sum_{j=1}^{k} \int_{\frac{j-1}{k}}^{\frac{j}{k}}
\frac{e^{-\frac{j}{5}}-e^{-\frac{j-1}{5}}}{1+x^2}
*\frac{e^{-x}}{e^{-\frac{j}{5}}-e^{-\frac{j-1}{5}}}d x \\
&amp;= \sum_{j=1}^{k} E
\frac{e^{-\frac{j}{5}}-e^{-\frac{j-1}{5}}}{1+X_{i}^2}\\
&amp; where X_{i}\sim
\frac{e^{-x}}{e^{-\frac{j}{5}}-e^{-\frac{j-1}{5}}}.
\end{aligned}\]</span>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span>M<span class="sc">/</span>k</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>T2<span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>est<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(M<span class="sc">/</span>k)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span>k)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>j<span class="sc">/</span>k)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">-</span>a<span class="sc">*</span>U)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    T2[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">*</span>a)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  est[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(T2)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(est),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.5248</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sd</span>(est),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00016</code></pre>
<p>From the result we can see that the estimation of <span class="math inline">\(\theta\)</span> is 0.5248, and an estimated
standard error is 0.00016,which is much smaller than 0.0970314.</p>
</div>
</div>
<div id="question11" class="section level2">
<h2>Question11</h2>
<p>6.4 Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are
a random sample from a lognormal distribution with unkonwn
parameters.Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>.Use a Monte Carlo method to obtain an
empirical estimate of the confidence level.</p>
<div id="answer11" class="section level3">
<h3>Answer11</h3>
<p>Because <span class="math inline">\(X_1,...X_n \sim
LN(\mu,\sigma^2)\)</span>, then <span class="math inline">\(log(X_1),...,log(X_n)\sim
N(\mu,\sigma^2)\)</span>. So <span class="math display">\[\frac{\frac1n\sum_{i=1}^n log(X_i)-\mu}{\sigma /
\sqrt{n}} \sim  N(0,1)\]</span> Let <span class="math inline">\(S^2\)</span> is the sample variance,then <span class="math display">\[ \frac{(n-1) S^{2}}{\sigma^{2}} \sim
\chi^{2}(n-1).\]</span> Thus <span class="math display">\[\frac{\frac1n\sum_{i=1}^n log(X_i)-\mu}{S /
\sqrt{n}} \sim  t(n-1)\]</span></p>
<p>So the <span class="math inline">\(100(1-\alpha)\%\)</span>
confidence intervals is given by <span class="math display">\[(\frac1n\sum_{i=1}^n
log(X_i)+\frac{S}{\sqrt{n}}t_{\frac{\alpha}{2}}(n-1),\frac1n\sum_{i=1}^n
log(X_i)-\frac{S}{\sqrt{n}}t_{\frac{\alpha}{2}}(n-1))\]</span></p>
<p>Now we assume that the sample size n = 20 from a Normal(2,4)
distribution.The calculation of 95% confidence of is shown below.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20221009</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># clear up memory</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>LCL <span class="ot">&lt;-</span>UCL<span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">mean =</span> <span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  LCL[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(x)<span class="sc">/</span>n <span class="sc">+</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  UCL[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(x)<span class="sc">/</span>n <span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(LCL<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> UCL<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 9510</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(LCL<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> UCL<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.951</code></pre>
<p>The result is that 9510 intervals satisfied(LCL&lt;2&lt;UCL),so the
empirical confidence level is 95.1% in this experiment,which is close to
the theoretical value , 95%.</p>
</div>
</div>
<div id="question12" class="section level2">
<h2>Question12</h2>
<p>Refer to Example 6.16.Repeat the simulation , but also compute the F
test of equal variance ,at significance level <span class="math inline">\(\hat \alpha \doteq 0.055\)</span>.Compare the
power of the Count Five test and F test for small ,medium,and large
sample size.(Recall that the F test is not applicable for non-normal
distribution).</p>
<div id="answer12" class="section level3">
<h3>Answer12</h3>
<p>Firstly,we write a function about Count Five test.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span>x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">&lt;-</span>y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X<span class="sc">&gt;</span><span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X<span class="sc">&lt;</span><span class="fu">min</span>(Y))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y<span class="sc">&gt;</span><span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y<span class="sc">&lt;</span><span class="fu">min</span>(X))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy))<span class="sc">&gt;</span><span class="dv">5</span>))</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then , I choose 6 sample sizes:20,100,500,1000,5000,10000.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span><span class="fl">1.5</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">5000</span>,<span class="dv">10000</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>power<span class="ot">&lt;-</span>FResult<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(m))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> m) {</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  test1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  test2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(i,<span class="dv">0</span>,sigma1)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(i,<span class="dv">0</span>,sigma2)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    test1[j] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x,y)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span>x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span> y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    test2[j] <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.055</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  power[z]<span class="ot">&lt;-</span><span class="fu">mean</span>(test1)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  FResult[z]<span class="ot">&lt;-</span><span class="fu">mean</span>(test2)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">size=</span>m,<span class="at">count5Test=</span>power,<span class="at">Ftest=</span>FResult)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##               [,1]     [,2]     [,3]      [,4]      [,5]  [,6]
## size       20.0000 100.0000 500.0000 1000.0000 5000.0000 10000
## count5Test  0.3100   0.8461   0.9914    0.9977    0.9998     1
## Ftest       0.4139   0.9799   1.0000    1.0000    1.0000     1</code></pre>
</div>
</div>
<div id="question13" class="section level2">
<h2>Question13</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level? (1)
What is the corresponding hypothesis test problem? (2) Which test can we
use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? (3)
Please provide the least necessary information for hypothesis
testing.</p>
<div id="answer13" class="section level3">
<h3>Answer13</h3>
<p>We can’t say the powers are different at 0.05 level.</p>
<p>Denote the power of the two test by <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, then the corresponding hypothesis
test problem is <span class="math display">\[
H_0:p_2-p_1=0\leftrightarrow H_1:p_2-p_1\neq 0.
\]</span> Now from the simulation we obtain that <span class="math inline">\(\hat p_1=0.651\)</span> and <span class="math inline">\(\hat p_2=0.676\)</span>, where the number of
trials is <span class="math inline">\(n=10000\)</span>.</p>
<p>Naturally we may assume that the <span class="math inline">\(10000\)</span> experiments are independent.
However, in each experiment, the results of the two tests are based on
the same data and parameters, thus they are not independent with each
other. Namely, we have obtained <span class="math inline">\(10000\)</span> paired data in the simulation.</p>
<p>Consequently, we cannot use two-sample t-test and Z-test (the large
sample version of two-sample t-test), because the two samples
corresponding to the two tests are not independent. Unfortunately, if we
want to apply paired t-test or McNemar test (an equivalent of paired
t-test for binary response data), the result of each experiment, namely,
whether the two tests reject or accept <span class="math inline">\(H_0\)</span>, is required.</p>
<p>In conclusion, we can use paired t-test or McNemar test provided the
result of each experiment. That means we cannot say the powers are
different at <span class="math inline">\(0.05\)</span> level if we only
know that <span class="math inline">\(\hat p_1=0.651\)</span> and <span class="math inline">\(\hat p_2=0.676\)</span> with size <span class="math inline">\(n=10000\)</span>. Note that it is more complicated
than testing the equivalence of type-I error, since the <strong>real
distribution of the data is unknown</strong> under the alternative
hypothesis!</p>
</div>
</div>
<div id="question14" class="section level2">
<h2>Question14</h2>
<p>7.4 Refer to air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
air-conditioning equipment: <span class="math display">\[3, 5, 7, 18,
43, 85, 91, 98, 100, 130, 230, 487.\]</span> Assume that the times
between failures follow an exponential model Exp().Obtain the MLE of the
hazard rate and use bootstrap to estimate the bias and standard error of
the estimate.</p>
<div id="answer14" class="section level3">
<h3>Answer14</h3>
<p>If <span class="math inline">\(X_1,...X_n\)</span> is the samples
from an exponential model EXP(),then the joint probability distribution
function is: <span class="math display">\[\begin{aligned}
f(x_1,...x_n) =&amp;\prod \limits_{i=0}^n \lambda*e^{-\lambda x_i} \\
=&amp;\lambda^n e^{-\sum_{i=0} ^{n} \lambda x_i}
\end{aligned}\]</span></p>
<p>Then the log likelihood function is <span class="math display">\[L(\lambda;x_1,...x_n) = nlog\lambda - \sum_{i=0}
^{n} \lambda x_i\]</span></p>
<p>Let <span class="math inline">\(\frac{\partial}{\partial
\lambda}L(\lambda;x_1,...x_n)=0\)</span> , we can know that the MLE of
<span class="math inline">\(\lambda\)</span> is <span class="math display">\[\hat \lambda = \frac{1}{\bar x} \quad,\]</span>
where <span class="math inline">\(\bar x\)</span> is the mean of the
sample.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>xbar</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<p>From the result of the R code ,we know that <span class="math inline">\(\bar x = 108.0833\)</span> , so <span class="math inline">\(\hat \lambda =\frac{1}{\bar x} =
0.00925212\)</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>bootstrap1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">20221014</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  lambdaStar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    lambdaStar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambdaStar)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>lambdaStar <span class="ot">&lt;-</span> <span class="fu">bootstrap1</span>(dt)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias =</span> <span class="fu">mean</span>(lambdaStar)<span class="sc">-</span>lambda,<span class="at">se.boot =</span> <span class="fu">sd</span>(lambdaStar)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    bias se.boot 
##   0.001   0.004</code></pre>
<p>So the bias of the estimate is 0.001, standard error of the estimate
is 0.004.</p>
</div>
</div>
<div id="question15" class="section level2">
<h2>Question15</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div id="answer15" class="section level3">
<h3>Answer15</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>lambda.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(dat,ind){</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(dat[ind])</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(dt,<span class="at">statistic=</span>lambda.boot,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&#39;bca&#39;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (-0.0007,  0.0166 )   (-0.0034,  0.0132 )  
## 
## Level     Percentile            BCa          
## 95%   ( 0.0053,  0.0219 )   ( 0.0046,  0.0188 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>From the result we can see that the percentile intervals and BCa
intervals are quite different from normal and basic interval. Inorder to
know why , we fist draw the histogram of the data.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.obj<span class="sc">$</span>t,<span class="at">probability =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the picture , we can know that the sampling distribution of
<span class="math inline">\(\frac{1}{\bar x}\)</span>is not close to
normal distribution . When the sampling distribution of the statistic is
approximately normal,the percentile intervals and BCa intervals will
agree with the normal interval.</p>
</div>
</div>
<div id="question16" class="section level2">
<h2>Question16</h2>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of
the standard normal bootstrap confidence interval, the basic bootstrap
confidence interval, and the percentile confidence interval. Sample from
a normal population and check the empirical coverage rates for the
sample mean. Find the proportion of times that the confidence intervals
miss on the left, and the porportion of times that the confidence
intervals miss on the right.</p>
<div id="answer16" class="section level3">
<h3>Answer16</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  x_bar</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>Sample3 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mea, sd){</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mea, sd)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>Analysis3 <span class="ot">&lt;-</span> <span class="cf">function</span>(m, func, Rr, n, mea, sd){</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(boot)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  nornorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  norbasi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  norperc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    Samp <span class="ot">&lt;-</span> <span class="fu">Sample3</span>(n, mea, sd)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    Skew <span class="ot">&lt;-</span> <span class="fu">boot</span>(Samp, <span class="at">statistic =</span> func, <span class="at">R=</span>Rr)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    Nor <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(Skew, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    nornorm[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    norbasi[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    norperc[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the coverage probability of a normal distribution</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  norm <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> nornorm[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  basi <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> norbasi[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  perc <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> norperc[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the probability of the left side of the normal distribution</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  normleft <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  basileft <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  percleft <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the right side probability of a normal distribution</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  normright <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>  basiright <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>  percright <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>  analyresu <span class="ot">&lt;-</span> <span class="fu">c</span>(norm, basi, perc, normleft, basileft, percleft, normright, basiright, percright)</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>  analyresu</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>Result3 <span class="ot">&lt;-</span> <span class="cf">function</span>(sd, analyresu){</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>  dnam <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;N ( 0 ,&quot;</span>, <span class="fu">as.character</span>(sd<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">seq=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  Distribution <span class="ot">&lt;-</span> <span class="fu">c</span>(dnam)</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  Type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>  Left <span class="ot">&lt;-</span> analyresu[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>  Right <span class="ot">&lt;-</span> analyresu[<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>  P.coverage <span class="ot">&lt;-</span> analyresu[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Distribution, Type, Left, Right, P.coverage)</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>  result</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>mea <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>Analyresu <span class="ot">&lt;-</span> <span class="fu">Analysis3</span>(m, skewness, R, n, mea, sd)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>Resu <span class="ot">&lt;-</span> <span class="fu">Result3</span>(sd, Analyresu)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span> (Resu, <span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">Distribution</th>
<th align="center">Type</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">P.coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">N ( 0 , 9 )</td>
<td align="center">basic</td>
<td align="center">0.037</td>
<td align="center">0.026</td>
<td align="center">0.937</td>
</tr>
<tr class="even">
<td align="center">N ( 0 , 9 )</td>
<td align="center">norm</td>
<td align="center">0.032</td>
<td align="center">0.025</td>
<td align="center">0.943</td>
</tr>
<tr class="odd">
<td align="center">N ( 0 , 9 )</td>
<td align="center">perc</td>
<td align="center">0.035</td>
<td align="center">0.027</td>
<td align="center">0.938</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="question17" class="section level2">
<h2>Question17</h2>
<p>Refer to Exercise 7.7.Obtain the jackknife estimate of bias and
standard error of <span class="math inline">\(\hat \theta\)</span>.</p>
<div id="answer17" class="section level3">
<h3>Answer17</h3>
<p>Denote <span class="math inline">\(\hat\theta_{(i)}=\hat\theta(x_1,\ldots,x_{i-1},x_{i+1},\ldots,x_n)\)</span>.
An unbiased estimate of the bias <span class="math inline">\(E(\hat\theta)-\theta_0\)</span> is <span class="math display">\[(n-1)(\bar{\hat\theta}_{(\cdot)}-\hat\theta)\]</span>
An estimate of <span class="math inline">\(se(\hat \theta)\)</span> is
<span class="math display">\[ \sqrt{\widehat{var}(\hat\theta)} = \sqrt{
\frac{n-1}n\sum_{i=1}^n(\hat\theta_{(i)}-\bar{\hat\theta}_{(\cdot)})^2}
\]</span></p>
<p>First we should calculate the sample variance , and then calculate
the eigenvalues of <span class="math inline">\(\hat\sum\)</span>. So the
sample estimate is <span class="math display">\[ \hat\theta =
\frac{\hat\lambda_1}{\sum_{j=1}^5 \hat\lambda_j}\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>thetaTrue <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  ei <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> ei<span class="sc">$</span>values[<span class="fu">order</span>(<span class="sc">-</span>(ei<span class="sc">$</span>values))]</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>jack <span class="ot">&lt;-</span> <span class="cf">function</span>(x,theta.hat,n){</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    x.jack <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i,]</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    theta.hat[i] <span class="ot">&lt;-</span> <span class="fu">thetaTrue</span>(x.jack)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  theta.hat</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(scor[,<span class="dv">1</span>])</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">thetaTrue</span>(scor)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">jack</span>(scor,theta.hat,n)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.hat<span class="sc">-</span>theta))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.hat<span class="sc">-</span>theta)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original.theta =</span> theta,<span class="at">bias.jack =</span> bias.jack,<span class="at">se.jack =</span> se.jack),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## original.theta      bias.jack        se.jack 
##         0.6191         0.0011         0.0496</code></pre>
</div>
</div>
<div id="question18" class="section level2">
<h2>Question18</h2>
<p>7.11 In Example 7.18, leave-one-out (n-fold) cross validation was
used to select the best fitting model. Use leave-two-out cross
validation to compare the models.</p>
<div id="answer18" class="section level3">
<h3>Answer18</h3>
<ol style="list-style-type: decimal">
<li>Linear: <span class="math inline">\(Y=\beta_{0}+\beta_{1}
X+\varepsilon\)</span> .</li>
<li>Quadratic: <span class="math inline">\(Y=\beta_{0}+\beta_{1}
X+\beta_{2} X^{2}+\varepsilon\)</span> .</li>
<li>Exponential: <span class="math inline">\(\log (Y)=\log
\left(\beta_{0}\right)+\beta_{1} X+\varepsilon\)</span> .</li>
<li>Log-Log: <span class="math inline">\(\log (Y)=\beta_{0}+\beta_{1}
\log (X)+\varepsilon\)</span> .</li>
</ol>
<p>First , I write a function to calculate the error of the four
models.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="cf">function</span>(n,data1,data2){</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span><span class="dv">1</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (j<span class="sc">&lt;=</span>n) {</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>       y<span class="ot">&lt;-</span> data1[<span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)]</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>       x<span class="ot">&lt;-</span> data2[<span class="fu">c</span>(<span class="sc">-</span>i,<span class="sc">-</span>j)]</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>       J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>       yhat1_i <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data2[i]</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>       yhat1_j <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data2[j]</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>       e1[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> data1[i] <span class="sc">-</span> yhat1_i</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>       e1[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> data1[j] <span class="sc">-</span> yhat1_j</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>       J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>       yhat2_i <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data2[i] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> data2[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>       yhat2_j <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data2[j] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> data2[j]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>       e2[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> data1[i] <span class="sc">-</span> yhat2_i</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>       e2[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> data1[j] <span class="sc">-</span> yhat2_j</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>       J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>       logyhat3_i <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data2[i]</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>       logyhat3_j <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data2[j]</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>       yhat3_i <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3_i)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>       yhat3_j <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3_j)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>       e3[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> data1[i] <span class="sc">-</span> yhat3_i</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>       e3[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> data1[j] <span class="sc">-</span> yhat3_j</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>       J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>       logyhat4_i <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(data2[i])</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>       logyhat4_j <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(data2[j])</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>       yhat4_i <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4_i)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>       yhat4_j <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4_j)</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>       e4[k,<span class="dv">1</span>] <span class="ot">&lt;-</span> data1[i] <span class="sc">-</span> yhat4_i</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>       e4[k,<span class="dv">2</span>] <span class="ot">&lt;-</span> data1[j] <span class="sc">-</span> yhat4_j</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>       k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>       j <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">list</span>(<span class="at">e1=</span>e1,<span class="at">e2=</span>e2,<span class="at">e3=</span>e3,<span class="at">e4=</span>e4,<span class="at">J1=</span>J1,<span class="at">J2=</span>J2,<span class="at">J3=</span>J3,<span class="at">J4=</span>J4))</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>err <span class="ot">&lt;-</span> <span class="fu">e</span>(n,magnetic,chemical)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> err<span class="sc">$</span>e1</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> err<span class="sc">$</span>e2</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>e3 <span class="ot">&lt;-</span> err<span class="sc">$</span>e3</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>e4 <span class="ot">&lt;-</span> err<span class="sc">$</span>e4</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>From the result , we can know that the quadratic model would be the
best fit for the data under the prediction error criterion .</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>err<span class="sc">$</span>J2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.22190     -1.43158      0.05408</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math display">\[\hat Y = 25.2219-1.413158X+0.05408X^2
\]</span></p>
</div>
</div>
<div id="question19" class="section level2">
<h2>Question19</h2>
<p>8.2 Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
<div id="answer19" class="section level3">
<h3>Answer19</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">13</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">6</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">20</span>,<span class="dv">9</span>,<span class="dv">4</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 2, p-value = 0.01667
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.9428571</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>rankx<span class="ot">&lt;-</span><span class="fu">rank</span>(x)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>ranky<span class="ot">&lt;-</span><span class="fu">rank</span>(y)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>spearman <span class="ot">&lt;-</span> <span class="fu">cor</span>(rankx,ranky)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">100000</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>rho_per <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  x_per<span class="ot">&lt;-</span><span class="fu">sample</span>(x)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  rankx_per<span class="ot">&lt;-</span> <span class="fu">rank</span>(x_per)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  y_per<span class="ot">&lt;-</span><span class="fu">sample</span>(y)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  ranky_per<span class="ot">&lt;-</span><span class="fu">rank</span>(y_per)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  rho_per[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(rankx_per,ranky_per)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(rho_per)<span class="sc">&gt;=</span><span class="fu">abs</span>(spearman))</span></code></pre></div>
<pre><code>## [1] 0.01652</code></pre>
<p>We can see that if we use cor.test,the p-value is 0.0167 . It is very
close to 0.01659 , which use permutation test.</p>
</div>
</div>
<div id="question20" class="section level2">
<h2>Question20</h2>
<p>9.4 Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<div id="answer20" class="section level3">
<h3>Answer20</h3>
<p>The density of the standard Laplace distribution is <span class="math display">\[f(x) = \frac1 2 e^{-|x|} \quad ,x \in
\mathbb{R}\]</span> 1) Set the proposal pdf g(X) to be the density of
normal distribution N(X,sigma).<br />
2) set X_0 = 5<br />
3) Repeat for i =2,3,…,N:<br />
(a) Generate Y from N($ X_{i-1}$,sigma)<br />
(b) Generate U from Uniform(0,1)<br />
(c) Computer <span class="math inline">\(\alpha\left(X_{i-1},
Y\right)=\frac{f(Y) g\left(X_{i-1} \mid Y\right)}{f\left(X_{i-1}\right)
g\left(Y \mid X_{i-1}\right)}\)</span> . Since we use random walk
Metropolis sampler , then <span class="math inline">\(g(X_{i-1} \mid Y)
= g(Y \mid X_{i-1}) = g((Y-X_{i-1})^2)\)</span> . So <span class="math inline">\(\alpha(X_{i-1},Y) =
\frac{f(Y)}{f(X_{i-1})}\)</span>. If <span class="math inline">\(U \leq
\alpha\left(X_{i-1}, Y\right)\)</span> accept Y and set <span class="math inline">\(X_{i}=Y\)</span> ; otherwise set <span class="math inline">\(X_{i}=X_{i-1}\)</span> .<br />
(d) Increment i.</p>
<p>First , I write a function to realize the random walk metropolis
sampler.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>randomWalk <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span>((<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y)))<span class="sc">/</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x[i<span class="dv">-1</span>]))))){</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then I choose six different sigma:0.05,0.50,2.00,5.00,10.00,20.00
.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22092</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.50</span>,<span class="fl">2.00</span>,<span class="fl">5.00</span>,<span class="fl">10.00</span>,<span class="fl">20.00</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>rw5 <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma[<span class="dv">5</span>],x0,N)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>rw6 <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma[<span class="dv">6</span>],x0,N)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>accept.rate <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>(rw1<span class="sc">$</span>k)<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>(rw2<span class="sc">$</span>k)<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>(rw3<span class="sc">$</span>k)<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>(rw4<span class="sc">$</span>k)<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">-</span>(rw5<span class="sc">$</span>k)<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">-</span>(rw6<span class="sc">$</span>k)<span class="sc">/</span>N)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sigma =</span> sigma, <span class="at">no.reject=</span><span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k,rw5<span class="sc">$</span>k,rw6<span class="sc">$</span>k), <span class="at">accept.rate =</span> accept.rate)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(accept)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sigma</th>
<th align="right">no.reject</th>
<th align="right">accept.rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">40</td>
<td align="right">0.9800</td>
</tr>
<tr class="even">
<td align="right">0.50</td>
<td align="right">341</td>
<td align="right">0.8295</td>
</tr>
<tr class="odd">
<td align="right">2.00</td>
<td align="right">930</td>
<td align="right">0.5350</td>
</tr>
<tr class="even">
<td align="right">5.00</td>
<td align="right">1421</td>
<td align="right">0.2895</td>
</tr>
<tr class="odd">
<td align="right">10.00</td>
<td align="right">1664</td>
<td align="right">0.1680</td>
</tr>
<tr class="even">
<td align="right">20.00</td>
<td align="right">1824</td>
<td align="right">0.0880</td>
</tr>
</tbody>
</table>
<p>From the table , we can see that the rate of acceptance decreases as
the variance of the Normal distribution increase.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))  <span class="co">#display 4 graphs together</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    refline <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.05</span>), <span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.05</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,  rw4<span class="sc">$</span>x,rw5<span class="sc">$</span>x,rw6<span class="sc">$</span>x)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h=</span>refline)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Use Germal-Rubin method to monitor convergence.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#psi[i,j] is the statistic psi(X[i,1:j]) for chain in i-th row of X</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)  <span class="co">#row means</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span>  n <span class="sc">*</span> <span class="fu">var</span>(psi.means)   <span class="co">#between variance est</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&#39;var&#39;</span>) <span class="co">#within variance</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat<span class="sc">/</span>W</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma){</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#choose overdispersed initial values</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generate the chains</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol =</span> n)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    X[i,] <span class="ot">&lt;-</span> <span class="fu">randomWalk</span>(sigma,x0[i],n)<span class="sc">$</span>x</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute diagnostic statistics</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>,cumsum))</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    psi[i,] <span class="ot">&lt;-</span> psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(psi)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>           <span class="co">#number of chains to generate</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>       <span class="co">#length of chains</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>        <span class="co">#burn-in length</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>,<span class="at">dim=</span><span class="fu">c</span>(k,n,<span class="fu">length</span>(sigma)))</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)) {</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  psi[,,i] <span class="ot">&lt;-</span> <span class="fu">r</span>(sigma[i])</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">length</span>(sigma),n)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)) {</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    rhat[i,j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j,i])</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="st">&#39;picture.jpg&#39;</span>,<span class="at">width=</span><span class="dv">200</span><span class="sc">*</span><span class="dv">4</span>,<span class="at">height=</span><span class="dv">200</span><span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)) {</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[i,(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;R&#39;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">1.8</span>))</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="question21" class="section level2">
<h2>Question21</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (<span class="math inline">\(X_t\)</span>, <span class="math inline">\(Y_t\)</span>),with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
<div id="answer21" class="section level3">
<h3>Answer21</h3>
<p>(1)The target distribution is bivariate normal: <span class="math inline">\(\left(X_{1}, X_{2}\right) \sim N\left(\mu_{1},
\mu_{2}, \sigma_{1}^{2}, \sigma_{2}^{2}, \rho\right)\)</span> .<br />
(2) Conditional distributions <span class="math inline">\(f\left(x_{1}
\mid x_{2}\right) and f\left(x_{2} \mid x_{1}\right)\)</span> :<br />
<span class="math display">\[\left(X_{1} \mid X_{2}\right) \sim
N\left(\mu_{1}+\rho \sigma_{1} /
\sigma_{2}\left(x_{2}-\mu_{2}\right),\left(1-\rho^{2}\right)
\sigma_{1}^{2}\right) \\
\left(X_{2} \mid X_{1}\right) \sim N\left(\mu_{2}+\rho \sigma_{2} /
\sigma_{1}\left(x_{1}-\mu_{1}\right),\left(1-\rho^{2}\right)
\sigma_{2}^{2}\right)\]</span></p>
<p>From the question ,we know that <span class="math inline">\(\mu_1=\mu_2=0,\sigma_1^2=\sigma_2^2=1,\rho=0.9\)</span>.
I set the length of chain is N=5000,and burn-in length is 1000.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22092</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">5000</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> s2<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1,mu2)  <span class="co">#initialize</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N,]</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(x)</span></code></pre></div>
<pre><code>## [1] -0.02238271 -0.02297119</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.9761387 0.8745081
## [2,] 0.8745081 0.9713759</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.8980788
## [2,] 0.8980788 1.0000000</code></pre>
<p>Using simple linear regression model to check the residuals of the
model for normality and constant variance.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">=</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>linReg <span class="ot">=</span> <span class="fu">lm</span>(V2<span class="sc">~</span>V1,<span class="at">data=</span>dt)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linReg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = V2 ~ V1, data = dt)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.36172 -0.29104 -0.00231  0.29541  1.55042 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.002919   0.006857  -0.426     0.67    
## V1           0.895885   0.006939 129.106   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4335 on 3998 degrees of freedom
## Multiple R-squared:  0.8065, Adjusted R-squared:  0.8065 
## F-statistic: 1.667e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>From the result , we can see that <span class="math inline">\(\hat
\beta\)</span> is almost same as 0.9.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(linReg))</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(linReg))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the Quantile-Quantile Plots,we can see the residuals of the
model is Approximate normal distribution.</p>
<p>Use Germal-Rubin method to monitor convergence.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>bivarchain <span class="ot">&lt;-</span> <span class="cf">function</span>(X,N){</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1<span class="sc">+</span>rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2<span class="sc">+</span>rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>G.R <span class="ot">&lt;-</span> <span class="cf">function</span>(B) {</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(B)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(B)</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(B)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>  B.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(B)    </span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(B.means)      </span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  B.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(B, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(B.w)               </span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (Z<span class="sc">/</span>n)     </span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             </span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>; burn <span class="ot">&lt;-</span> <span class="dv">1000</span>; X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1;s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span>       <span class="co">#length of chains</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>        <span class="co">#burn-in length</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>) </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span>y1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,N)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  X1[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1[i], mu2[i])</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">bivarchain</span>(X1,N)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  x1[i,] <span class="ot">&lt;-</span> X1[,<span class="dv">1</span>]</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  y1[i,] <span class="ot">&lt;-</span> X1[,<span class="dv">2</span>]</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>B1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x1, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>B2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(y1, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(B1)){</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  B1[i,] <span class="ot">&lt;-</span> B1[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(B1))</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(B2)){</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>  B2[i,] <span class="ot">&lt;-</span> B2[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(B2))</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>rhatx <span class="ot">&lt;-</span> rhaty <span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> b<span class="sc">:</span>N){</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>  rhatx[j] <span class="ot">&lt;-</span> <span class="fu">G.R</span>(B1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>  rhaty[j] <span class="ot">&lt;-</span> <span class="fu">G.R</span>(B2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhatx[b<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhaty[b<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question22" class="section level2">
<h2>Question22</h2>
<p>Test intermediary effect: <span class="math display">\[H_0:\alpha
\beta=0 \quad VS \quad H_a:\alpha \beta \neq 0 \]</span></p>
<div id="answer22" class="section level3">
<h3>Answer22</h3>
<p>Consider the model: <span class="math display">\[M = a_M + \alpha X +
e_M\]</span> <span class="math display">\[Y = a_Y + \beta M+ \gamma X +
e_Y \]</span></p>
<p>Suppose <span class="math inline">\(X \sim N(0,1) ,e_M \sim
N(0,1),e_Y \sim N(0,1),a_M=1,a_Y=1,\gamma=1,a_M=1,a_Y=1\)</span></p>
<p>The test statistics is <span class="math display">\[T=\frac{\hat{\alpha}\hat{\beta}}{\hat{se}(\hat{\alpha}\hat{\beta})}=\frac{\hat{\alpha}\hat{\beta}}{\sqrt{\hat{\alpha}^2\hat{s}_\beta^2+\hat{\beta}^2\hat{s}_\alpha^2}}\]</span></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate sample</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>generateSample <span class="ot">&lt;-</span> <span class="cf">function</span>(n,alpha,beta){</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span>a_M<span class="ot">&lt;-</span>a_Y<span class="ot">&lt;-</span> <span class="dv">1</span>;</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> a_M<span class="sc">+</span>alpha<span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> a_Y<span class="sc">+</span>beta<span class="sc">*</span>M<span class="sc">+</span>gamma<span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(X,M,Y))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The function of test statistics computation</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>Ttest <span class="ot">&lt;-</span> <span class="cf">function</span>(X,M,Y){</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(M<span class="sc">~</span>X))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M))</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  sea <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  seb <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>b<span class="sc">/</span>((a<span class="sc">*</span>seb)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(b<span class="sc">*</span>sea)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>Imptest <span class="ot">&lt;-</span> <span class="cf">function</span>(N,n,X,M,Y,T0){</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  T1 <span class="ot">&lt;-</span> T2 <span class="ot">&lt;-</span> T3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 1</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[n1];M1 <span class="ot">&lt;-</span> M[n2];Y1 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    T1[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X1,M1,Y1)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 2</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> X[n1];M2 <span class="ot">&lt;-</span> M[n1];Y2 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    T2[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X2,M2,Y2)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 3</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    M3 <span class="ot">&lt;-</span> M[n1];X3 <span class="ot">&lt;-</span> X[n2];Y3 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>    T3[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X3,M3,Y3)</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition1</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T1))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition2</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T2))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition3</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T3))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(p1,p2,p3))</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># The number of simulation</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># The number of random sample</span></span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>T0 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a><span class="co"># The real values of parameters</span></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>);beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">generateSample</span>(n,alpha[i],beta[i])</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> result[[<span class="dv">1</span>]]</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> result[[<span class="dv">2</span>]]</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> result[[<span class="dv">3</span>]]</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The original value of test statistics</span></span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>  T0[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X,M,Y)</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  p[i,] <span class="ot">&lt;-</span> <span class="fu">Imptest</span>(N,n,X,M,Y,T0[i])</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The output is show bellow:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Condition 1&quot;</span>,<span class="st">&quot;Condition 2&quot;</span>,<span class="st">&quot;Condition 3&quot;</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;alpha=0,beta=0&quot;</span>,<span class="st">&quot;alpha=0,beta=1&quot;</span>,<span class="st">&quot;alpha=1,beta=0&quot;</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##                Condition 1 Condition 2 Condition 3
## alpha=0,beta=0  0.47252747   0.1978022   0.1928072
## alpha=0,beta=1  0.02197802   0.0000000   0.0000000
## alpha=1,beta=0  0.83916084   0.8621379   0.7172827</code></pre>
</div>
</div>
<div id="question23" class="section level2">
<h2>Question23</h2>
<p>Consider the model <span class="math inline">\(P(Y=1|X_1,X_2,X_3)=expit(a+b_1x_1+b_2x_2+b_3x_3),X_1
\sim Possion(1),X_2 \sim Exp(1),X_3 \sim B(1,0.5)\)</span><br />
(1)Write a function to realize the above functions,and its input values
is <span class="math inline">\(N,b_1,b_2,b_3,f_0\)</span>, the output is
alpha.<br />
(2)Call this function, and the input value is<span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span><br />
(3)Plot <span class="math inline">\(f_0 vs alpha\)</span> Scatter
plot.</p>
<div id="answer23" class="section level3">
<h3>Answer23</h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>solveAlpha <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">g</span>(a)<span class="sc">&gt;</span><span class="dv">0</span>) {</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> a<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">g</span>(b)<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> b<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(a,b))</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>;b1<span class="ot">&lt;-</span><span class="dv">0</span>;b2<span class="ot">&lt;-</span><span class="dv">1</span>;b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>);x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N);x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>alphaPred <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(f0))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)) {</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  alphaPred[i] <span class="ot">&lt;-</span> <span class="fu">solveAlpha</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>alphaPred</span></code></pre></div>
<pre><code>## [1]  -3.166632  -6.070338  -8.704527 -11.224159</code></pre>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>f0[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>alphaPred <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  f0[i] <span class="ot">&lt;-</span>f0[i<span class="dv">-1</span>]<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)) {</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  alphaPred[i] <span class="ot">&lt;-</span> <span class="fu">solveAlpha</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),alphaPred,<span class="at">main=</span><span class="st">&#39;f0 vs alpha&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question24" class="section level2">
<h2>Question24</h2>
<p>Suppose <span class="math inline">\(X_1,...,X_n \sim
Exp(\lambda)\)</span>.Due to some reason,we can only know that <span class="math inline">\(X_i\)</span> falls in a certain interval(<span class="math inline">\(u_i,v_i\)</span>),and <span class="math inline">\(u_i,v_i\)</span> are two known non random
constant.This data is called interval deletion data.<br />
(1) Try to directly maximize the likelihood function of observation data
and the MLE of <span class="math inline">\(\lambda\)</span> to be solved
by EM algorithm respectively, and prove that they are equal.<br />
(2)Suppose the observed data of <span class="math inline">\((u_i,v_i),i=1,...,n(=10)\)</span> is
(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)
.Try to program the above two algorithms separately to obtain the MLE
numerical solution of <span class="math inline">\(\lambda\)</span></p>
<div id="answer24" class="section level3">
<h3>Answer24</h3>
<p>The likelihood function of the observed data is :</p>
<p><span class="math display">\[
\begin{align}
L(\lambda) =&amp; \prod_{i=1}^n P_{\lambda}(u_i \leq X_i \leq v_i)\\
=&amp; \prod_{i=1}^n \int_{u_i}^{v_i} \lambda e^{-\lambda x}dx \\
=&amp; \prod_{i=1}^n (e^{-\lambda u_i }-e^{-\lambda v_i}) \\
\end{align}
\]</span> <span class="math display">\[\frac{ \partial }{ \partial
\lambda } lnL(\lambda)= 0 \\
\sum_{i=1}^n \frac{v_ie^{-\lambda v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda
u_i }-e^{-\lambda v_i}} = 0
\]</span> EM algorithm: <span class="math display">\[l_c(\lambda) =
\sum_{i=1}^n logf_{\lambda}(x_i) = nlog\lambda - \lambda
\sum_{i=1}^nx_i\]</span> E-step: <span class="math display">\[
\begin{align}
&amp;E_{\hat \lambda_0}(l_c(\lambda)|X_i \in(u_i,v_i),i=1,...,n ) \\
=&amp; nlog\lambda - \lambda\sum_{i=1}^n E_{\hat \lambda_0}(X_i|X_i \in
(u_i,v_i))\\
=&amp; nlog\lambda - \lambda\sum_{i=1}^n
(\frac{1}{\hat{\lambda}_0}+\frac{u_{i} e^{-\hat{\lambda}_0 u_{i}}-v_{i}
e^{-\hat{\lambda}_0 v_{i}}}{e^{-\hat{\lambda}_0
u_{i}}-e^{-\hat{\lambda}_0 v_{i}}}) \\
= &amp;nlog(\lambda) - \lambda \sum_{i=1}^n \hat X_i^{(1)}
\end{align}
\]</span> M-step : Maximize new logarithmic likelihood function <span class="math inline">\(E_{\hat \lambda_0}(l_c(\lambda)|X_i
\in(u_i,v_i),i=1,...,n )=nlog(\lambda) - \lambda \sum_{i=1}^n \hat
X_i^{(1)}\)</span>, where <span class="math inline">\(\hat
X_i^{(1)}=\frac{1}{\hat{\lambda}_0}+\frac{u_{i} e^{-\hat{\lambda}_0
u_{i}}-v_{i} e^{-\hat{\lambda}_0 v_{i}}}{e^{-\hat{\lambda}_0
u_{i}}-e^{-\hat{\lambda}_0 v_{i}}}\)</span> . So <span class="math inline">\(\hat \lambda_1 = \frac{n}{\sum_{i=1}^n \hat
X_i^{(1)}}\)</span> E-step and M-step are staggered until the algorithm
converges. If the algorithm converges, the <span class="math inline">\(\hat{\lambda}^{(\infty)}\)</span> is<br />
<span class="math display">\[\hat{\lambda}^{(\infty)}=\frac{n}{\sum_{i=1}^{n}\left(\frac{1}{\hat{\lambda}^{(\infty)}}+\frac{u_{i}
e^{-\hat{\lambda}(\infty)} u_{i}-v_{i} e^{-\hat{\lambda}(\infty)}
v_{i}}{e^{-\hat{\lambda}(\infty)} u_{i}-e^{-\hat{\lambda}(\infty)}
v_{i}}\right)}\]</span> so <span class="math inline">\(\hat{\lambda}^{(\infty)}\)</span> satisfy the
equation <span class="math display">\[\frac{u_{i}
e^{-\hat{\lambda}(\infty)} u_{i}-v_{i} e^{-\hat{\lambda}(\infty)}
v_{i}}{e^{-\hat{\lambda}(\infty)} u_{i}-e^{-\hat{\lambda}(\infty)}
v_{i}}=0\]</span> which is the same when we directly maximize the
likelihood function.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">27</span>,<span class="dv">28</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">24</span>,<span class="dv">25</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">nrow =</span> <span class="dv">10</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>lkhood <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  sm <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dt)) {</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    sm <span class="ot">&lt;-</span> sm <span class="sc">+</span> (dt[i,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">1</span>]) <span class="sc">-</span> dt[i,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">2</span>]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">2</span>]))</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  sm</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>lambdaM <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(lkhood,<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.05</span>))</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>lambdaM<span class="sc">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07197522</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>EMAlgorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(dt,lambda){</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  x_hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(dt))</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dt)) {</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    x_hat[i] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>lambda <span class="sc">+</span> (dt[i,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">1</span>]) <span class="sc">-</span> dt[i,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">2</span>]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>dt[i,<span class="dv">2</span>]))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">nrow</span>(dt)<span class="sc">/</span><span class="fu">sum</span>(x_hat))</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>lambda0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>lambda1<span class="ot">&lt;-</span> <span class="fu">EMAlgorithm</span>(dt,lambda0)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda0)<span class="sc">&gt;</span>eps) {</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  lambda0 <span class="ot">&lt;-</span> lambda1</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  lambda1 <span class="ot">&lt;-</span> <span class="fu">EMAlgorithm</span>(dt,lambda0)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>lambda1</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
</div>
</div>
<div id="question25" class="section level2">
<h2>Question25</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<div id="answer25" class="section level3">
<h3>Answer25</h3>
<p>The elements in lists can be heterogeneous. It can be any
type,including list,vector,matrix and so on. So before convert a list to
an atomic vector , it need to be unlisted first . A list is already a
vector , so if we use as.vector() , it can’t convert the list to an
atomic vector.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fu">list</span>(<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">unlist</span>(a))</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] 1 2 4 5</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(a)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [[3]][[1]]
## [1] 4
## 
## [[3]][[2]]
## [1] 5</code></pre>
</div>
</div>
<div id="question26" class="section level2">
<h2>Question26</h2>
<p>why is 1 == ‘1’ true ? Why is -1 &lt; FALSE true ? Why is ‘one’ &lt;
2 false?</p>
<div id="answer26" class="section level3">
<h3>Answer26</h3>
<p>Because when we use operator-functions , the arguments will be
coerced to a common type . So 1 will be coerced to ‘1’;FALSE will be
represented as 0; 2 will be coerced to ‘2’(and numbers precede letters
in lexicographic order).</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span> <span class="sc">==</span> <span class="st">&#39;1&#39;</span>,<span class="sc">-</span><span class="dv">1</span><span class="sc">&lt;</span><span class="cn">FALSE</span>,<span class="st">&#39;one&#39;</span> <span class="sc">&lt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<div id="question27" class="section level2">
<h2>Question27</h2>
<p>What does dim() return when applied to a vector?</p>
<div id="answer27" class="section level3">
<h3>Answer27</h3>
<p>dim() will return NULL when applied to a 1d vector.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
</div>
<div id="question28" class="section level2">
<h2>Question28</h2>
<p>If is.matrix(x) is TRUE,what will is.array(x) return?</p>
<div id="answer28" class="section level3">
<h3>Answer28</h3>
<p>It will also return TRUE.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(ma)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(ma)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="question29" class="section level2">
<h2>Question29</h2>
<p>What attribute does a data frame possess?</p>
<div id="answer29" class="section level3">
<h3>Answer29</h3>
<p>names , class , row.names We can use attributes() function to
test.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(col1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">col2=</span><span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>,<span class="st">&#39;z&#39;</span>))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(df)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;col1....1.3&quot; &quot;col2&quot;       
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2 3</code></pre>
</div>
</div>
<div id="question30" class="section level2">
<h2>Question30</h2>
<p>Can you have a data frame with 0 rows?What about 0 columns?</p>
<div id="answer30" class="section level3">
<h3>Answer30</h3>
<p>Yes, we can create such data frame.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(),<span class="at">b=</span><span class="fu">character</span>())</span></code></pre></div>
<pre><code>## [1] b
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## data frame with 0 columns and 5 rows</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
</div>
</div>
<div id="question31" class="section level2">
<h2>Question31</h2>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?<br />
scale01 &lt;- function(x) {<br />
rng &lt;- range(x, na.rm = TRUE)<br />
(x - rng[1]) / (rng[2] - rng[1])<br />
}</p>
<div id="answer31" class="section level3">
<h3>Answer31</h3>
<p>We can check whether the input is a number through if clause.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(mtcars, <span class="cf">function</span>(x) <span class="cf">if</span>( <span class="fu">is.numeric</span>(x)) <span class="fu">round</span>(<span class="fu">scale01</span>(x),<span class="dv">4</span>) <span class="cf">else</span> x))</span></code></pre></div>
<pre><code>##       mpg cyl   disp     hp   drat     wt   qsec vs am gear   carb
## 1  0.4511 0.5 0.2218 0.2049 0.5253 0.2830 0.2333  0  1  0.5 0.4286
## 2  0.4511 0.5 0.2218 0.2049 0.5253 0.3482 0.3000  0  1  0.5 0.4286
## 3  0.5277 0.0 0.0920 0.1449 0.5023 0.2063 0.4893  1  1  0.5 0.0000
## 4  0.4681 0.5 0.4662 0.2049 0.1475 0.4352 0.5881  1  0  0.0 0.0000
## 5  0.3532 1.0 0.7206 0.4346 0.1797 0.4927 0.3000  0  0  0.0 0.1429
## 6  0.3277 0.5 0.3839 0.1873 0.0000 0.4978 0.6810  1  0  0.0 0.0000
## 7  0.1660 1.0 0.7206 0.6820 0.2074 0.5260 0.1595  0  0  0.0 0.4286
## 8  0.5957 0.0 0.1886 0.0353 0.4286 0.4288 0.6548  1  0  0.5 0.1429
## 9  0.5277 0.0 0.1739 0.1519 0.5346 0.4186 1.0000  1  0  0.5 0.1429
## 10 0.3745 0.5 0.2407 0.2509 0.5346 0.4927 0.4524  1  0  0.5 0.4286
## 11 0.3149 0.5 0.2407 0.2509 0.5346 0.4927 0.5238  1  0  0.5 0.4286
## 12 0.2553 1.0 0.5106 0.4523 0.1429 0.6538 0.3452  0  0  0.0 0.2857
## 13 0.2936 1.0 0.5106 0.4523 0.1429 0.5669 0.3690  0  0  0.0 0.2857
## 14 0.2043 1.0 0.5106 0.4523 0.1429 0.5796 0.4167  0  0  0.0 0.2857
## 15 0.0000 1.0 1.0000 0.5406 0.0783 0.9555 0.4143  0  0  0.0 0.4286
## 16 0.0000 1.0 0.9701 0.5760 0.1106 1.0000 0.3952  0  0  0.0 0.4286
## 17 0.1830 1.0 0.9202 0.6290 0.2166 0.9798 0.3476  0  0  0.0 0.4286
## 18 0.9362 0.0 0.0190 0.0495 0.6083 0.1757 0.5917  1  1  0.5 0.0000
## 19 0.8511 0.0 0.0115 0.0000 1.0000 0.0261 0.4786  1  1  0.5 0.1429
## 20 1.0000 0.0 0.0000 0.0459 0.6728 0.0823 0.6429  1  1  0.5 0.0000
## 21 0.4723 0.0 0.1222 0.1590 0.4332 0.2434 0.6560  1  0  0.0 0.0000
## 22 0.2170 1.0 0.6159 0.3463 0.0000 0.5132 0.2821  0  0  0.0 0.1429
## 23 0.2043 1.0 0.5809 0.3463 0.1797 0.4914 0.3333  0  0  0.0 0.1429
## 24 0.1234 1.0 0.6957 0.6820 0.4470 0.5950 0.1083  0  0  0.0 0.4286
## 25 0.3745 1.0 0.8204 0.4346 0.1475 0.5963 0.3036  0  0  0.0 0.1429
## 26 0.7191 0.0 0.0197 0.0495 0.6083 0.1079 0.5238  1  1  0.5 0.0000
## 27 0.6638 0.0 0.1227 0.1378 0.7696 0.1603 0.2619  0  1  1.0 0.1429
## 28 0.8511 0.0 0.0599 0.2155 0.4654 0.0000 0.2857  1  1  1.0 0.1429
## 29 0.2298 1.0 0.6982 0.7491 0.6728 0.4237 0.0000  0  1  1.0 0.4286
## 30 0.3957 0.5 0.1843 0.4346 0.3963 0.3214 0.1190  0  1  1.0 0.7143
## 31 0.1957 1.0 0.5735 1.0000 0.3594 0.5260 0.0119  0  1  1.0 1.0000
## 32 0.4681 0.0 0.1245 0.2014 0.6221 0.3240 0.4881  1  1  0.5 0.1429</code></pre>
</div>
</div>
<div id="question32" class="section level2">
<h2>Question32</h2>
<p>Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data
frame.<br />
b) Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p>
<div id="answer32" class="section level3">
<h3>Answer32</h3>
<ol style="list-style-type: lower-alpha">
<li>The dataset mtcars is a numeric data frame.</li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>The dataset iris is a mixed data fame.</li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
</div>
</div>
<div id="question33" class="section level2">
<h2>Question33</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation
0.9.<br />
(1)Write an Rcpp function.<br />
(2)Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.<br />
(3)Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<div id="answer33" class="section level3">
<h3>Answer33</h3>
<p>The target distribution is bivariate normal: <span class="math inline">\(\left(X_{1}, X_{2}\right) \sim N\left(\mu_{1},
\mu_{2}, \sigma_{1}^{2}, \sigma_{2}^{2}, \rho\right)\)</span> .<br />
Conditional distributions <span class="math inline">\(f\left(x_{1} \mid
x_{2}\right) and f\left(x_{2} \mid x_{1}\right)\)</span> :<br />
<span class="math display">\[\left(X_{1} \mid X_{2}\right) \sim
N\left(\mu_{1}+\rho \sigma_{1} /
\sigma_{2}\left(x_{2}-\mu_{2}\right),\left(1-\rho^{2}\right)
\sigma_{1}^{2}\right) \\
\left(X_{2} \mid X_{1}\right) \sim N\left(\mu_{2}+\rho \sigma_{2} /
\sigma_{1}\left(x_{1}-\mu_{1}\right),\left(1-\rho^{2}\right)
\sigma_{2}^{2}\right)\]</span></p>
<p>From the question ,we know that <span class="math inline">\(\mu_1=\mu_2=0,\sigma_1^2=\sigma_2^2=1,\rho=0.9\)</span>.
I set the length of chain is N=5000,and burn-in length is 1000.</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbsC(int N){</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="st">    NumericMatrix X(N,2);</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="st">    double mu1 = 0,mu2=0;</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="st">    double sigma1= 1,sigma2 = 1;</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="st">    double rho = 0.9;</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="st">    double s1 = sqrt(1-rho*rho)*sigma1;</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="st">    double s2 = sqrt(1-rho*rho)*sigma1;</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="st">    X(0,0) = 0;</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="st">    X(0,1) = 0;</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="st">    for (int i = 1; i &lt; N; i++)</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a><span class="st">    {</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="st">        for (int j = 0; j &lt; 2; j++)</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a><span class="st">        {</span></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="st">            double x2 = X(i - 1, 1);</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="st">            double m1 = mu1 + rho * (x2 - mu2) * sigma1 / sigma2;</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="st">            X(i,0) = R::rnorm(m1,s1);</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="st">            double x1 = X(i - 1, 0);</span></span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="st">            double m2 = mu1 + rho * (x2 - mu2) * sigma1 / sigma2;</span></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="st">            X(i,1) = R::rnorm(m2,s2);</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="st">    return X;</span></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20221118</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N){</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span>N</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>  rho <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  mu1 <span class="ot">&lt;-</span>mu2<span class="ot">&lt;-</span><span class="dv">0</span>;</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  sigma1 <span class="ot">&lt;-</span>sigma2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> s2<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1,mu2)  <span class="co">#initialize</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>gxC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(<span class="dv">5000</span>)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">5000</span>,<span class="dv">1</span>]</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>gxR <span class="ot">&lt;-</span> <span class="fu">GibbsR</span>(<span class="dv">5000</span>)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">5000</span>,<span class="dv">1</span>]</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gxC,gxR)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>gyC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(<span class="dv">5000</span>)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">5000</span>,<span class="dv">2</span>]</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>gyR <span class="ot">&lt;-</span> <span class="fu">GibbsR</span>(<span class="dv">5000</span>)[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">5000</span>,<span class="dv">2</span>]</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(gyC,gyR)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR =</span> <span class="fu">GibbsR</span>(<span class="dv">1000</span>),<span class="at">gibbc =</span> <span class="fu">gibbsC</span>(<span class="dv">1000</span>))</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr       lq    median       uq
## 1 gibbR 2925.351 3040.5510 3489.452
## 2 gibbc  175.551  179.4005  184.601</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
